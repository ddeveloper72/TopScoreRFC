import{b as xe}from"./chunk-PS35L4IK.js";import{f as he,l as _e,m as Me,p as Ee,q as Ce}from"./chunk-FWJNL5VF.js";import{a as H}from"./chunk-5KLTPYYT.js";import{$ as ve,A as X,B as Y,C as Z,E as ee,F as te,G as ne,L as ie,M as ae,O as oe,Q as u,S as re,T as me,W as le,X as de,Y as se,Z as ce,_ as pe,b as z,ba as ue,da as ge,ea as fe,u as U,v as J,x as K,y as Q,z as W}from"./chunk-DQ44BQH3.js";import{Aa as V,Ba as G,Ca as L,Da as R,Ea as $,pa as k,ua as A,va as B,wa as N,ya as j,za as q}from"./chunk-LIMVPQML.js";import{Bb as d,Eb as C,Kb as t,Lb as e,Mb as h,Qb as P,Qc as I,Rc as T,Tb as c,Vb as p,Vc as F,Wc as w,a as x,b as y,bb as r,cb as s,dc as n,ec as v,fc as g,gc as b,ob as S,pa as M,pc as D,qa as E,rc as O,ub as f}from"./chunk-JMAXUHPF.js";function Se(m,a){m&1&&(t(0,"mat-error"),n(1," Please enter time in MM:SS format "),e())}function Pe(m,a){if(m&1&&(t(0,"div",57)(1,"mat-icon"),n(2,"person"),e(),n(3),e()),m&2){let i=p().$implicit;r(3),g(" ",i.ourPlayer," ")}}function be(m,a){if(m&1&&(t(0,"div",58)(1,"em"),n(2),e()()),m&2){let i=p().$implicit;r(2),v(i.notes)}}function De(m,a){if(m&1){let i=P();t(0,"div",43)(1,"div",44)(2,"div",45)(3,"span",46),n(4),e(),t(5,"span",47),n(6),e(),t(7,"span",48),n(8),e()(),t(9,"div",49),n(10),e()(),t(11,"div",50)(12,"div",51),n(13),e(),f(14,Pe,4,1,"div",52)(15,be,3,1,"div",53),e(),t(16,"div",54)(17,"button",55),c("click",function(){let l=M(i).$implicit,_=p(2);return E(_.editEvent(l))}),t(18,"mat-icon"),n(19,"edit"),e()(),t(20,"button",56),c("click",function(){let l=M(i).$implicit,_=p(2);return E(_.deleteEvent(l))}),t(21,"mat-icon"),n(22,"delete"),e()()()()}if(m&2){let i=a.$implicit,o=p(2);C("event-"+i.eventType),r(4),v(i.time),r(2),v(o.getEventIcon(i.eventType)),r(2),v(o.formatEventType(i.eventType)),r(),C(i.team),r(),g(" ",i.team==="home"?o.data.match.homeTeam:o.data.match.awayTeam," "),r(3),v(i.description),r(),d("ngIf",i.ourPlayer),r(),d("ngIf",i.notes)}}function Oe(m,a){if(m&1&&(t(0,"mat-card",40)(1,"mat-card-header")(2,"mat-card-title"),n(3),e()(),t(4,"mat-card-content")(5,"div",41),f(6,De,23,11,"div",42),e()()()),m&2){let i=p();r(3),g("Match Events (",i.events.length,")"),r(3),d("ngForOf",i.sortedEvents)}}function Ie(m,a){m&1&&(t(0,"div",59)(1,"mat-icon"),n(2,"event_note"),e(),t(3,"h3"),n(4,"No events recorded yet"),e(),t(5,"p"),n(6,"Add your first match event using the form above"),e()())}var ye=class m{constructor(a,i,o,l,_,Te){this.fb=a;this.dialogRef=i;this.data=o;this.matchApi=l;this.matchStorage=_;this.snackBar=Te;this.eventForm=this.fb.group({time:["",[u.required,u.pattern(this.timePattern)]],period:["first",u.required],eventType:["",u.required],team:["home",u.required],ourPlayer:[""],description:["",u.required],notes:[""]})}eventForm;events=[];isLoading=!1;timePattern=/^[0-9]{1,2}:[0-5][0-9]$/;ngOnInit(){this.loadEvents()}get sortedEvents(){return this.events.sort((a,i)=>{let o=this.convertTimeToMinutes(a.time),l=this.convertTimeToMinutes(i.time);return o-l})}convertTimeToMinutes(a){let[i,o]=a.split(":").map(Number);return i+o/60}loadEvents(){this.events=this.data.match.events||[]}addEvent(){if(this.eventForm.valid&&!this.isLoading){this.isLoading=!0;let a=this.eventForm.value;if(a.pointsSnapshot=(this.data.match.homeScore||0)+(this.data.match.awayScore||0),this.data.match._id)this.matchApi.addMatchEvent(this.data.match._id,a).subscribe({next:i=>{this.events.push(i.event),this.matchStorage.addEventToMatch(this.data.match.id||this.data.match._id,i.event),this.snackBar.open("Event added successfully!","Close",{duration:3e3}),this.resetForm(),this.isLoading=!1},error:i=>{console.error("Error adding event:",i),this.snackBar.open("Error adding event. Please try again.","Close",{duration:5e3}),this.isLoading=!1}});else{let i=y(x({},a),{_id:Date.now().toString(),createdAt:new Date,updatedAt:new Date});this.events.push(i),this.matchStorage.addEventToMatch(this.data.match.id,i),this.snackBar.open("Event added locally!","Close",{duration:3e3}),this.resetForm(),this.isLoading=!1}}}editEvent(a){this.eventForm.patchValue({time:a.time,period:a.period,eventType:a.eventType,team:a.team,ourPlayer:a.ourPlayer||"",description:a.description,notes:a.notes||""}),this.deleteEvent(a,!1)}deleteEvent(a,i=!0){if(i&&!confirm("Are you sure you want to delete this event?"))return;let o=this.events.findIndex(l=>l._id===a._id);o>-1&&(this.events.splice(o,1),this.data.match._id&&a._id?this.matchApi.deleteMatchEvent(this.data.match._id,a._id).subscribe({next:()=>{this.matchStorage.deleteEventFromMatch(this.data.match.id||this.data.match._id,a._id),i&&this.snackBar.open("Event deleted successfully!","Close",{duration:3e3})},error:l=>{console.error("Error deleting event:",l),i&&this.snackBar.open("Error deleting event. Please try again.","Close",{duration:5e3})}}):(this.matchStorage.deleteEventFromMatch(this.data.match.id,a._id),i&&this.snackBar.open("Event deleted locally!","Close",{duration:3e3})))}resetForm(){this.eventForm.reset({period:"first",team:"home"})}getEventIcon(a){switch(a){case"try":return"\u{1F3C9}";case"conversion":return"\u26BD";case"penalty":return"\u{1F3AF}";case"drop_goal":return"\u{1F3C8}";case"card":return"\u{1F7E8}";case"injury":return"\u{1FA79}";case"substitution":return"\u{1F504}";default:return"\u{1F4DD}"}}formatEventType(a){switch(a){case"try":return"Try";case"conversion":return"Conversion";case"penalty":return"Penalty";case"drop_goal":return"Drop Goal";case"card":return"Card";case"injury":return"Injury";case"substitution":return"Substitution";default:return a.charAt(0).toUpperCase()+a.slice(1)}}close(){this.dialogRef.close()}saveAndClose(){this.data.match.events=this.events,this.dialogRef.close(this.data.match)}static \u0275fac=function(i){return new(i||m)(s(ve),s(U),s(J),s(xe),s(H),s(Y))};static \u0275cmp=S({type:m,selectors:[["app-event-manager-dialog"]],decls:105,vars:14,consts:[[1,"event-manager-container"],["mat-dialog-title",""],[1,"match-info"],[1,"match-date"],[1,"dialog-content"],[1,"add-event-card"],[1,"event-form",3,"formGroup"],[1,"form-row"],["appearance","outline"],["matInput","","formControlName","time","placeholder","15:30","required","",3,"pattern"],[4,"ngIf"],["formControlName","period","required",""],["value","first"],["value","second"],["value","extra"],["formControlName","eventType","required",""],["value","try"],[1,"event-option"],["value","conversion"],["value","penalty"],["value","drop_goal"],["value","card"],["value","injury"],["value","substitution"],["value","other"],["formControlName","team","required",""],["value","home"],["value","away"],["appearance","outline",1,"full-width"],["matInput","","formControlName","ourPlayer","placeholder","Player name (for home team events)"],["matInput","","formControlName","description","placeholder","Describe what happened...","rows","2","required",""],["matInput","","formControlName","notes","placeholder","Any additional context or observations...","rows","2"],[1,"form-actions"],["mat-raised-button","","color","primary","type","button",3,"click","disabled"],["mat-button","","type","button",3,"click"],["class","events-list-card",4,"ngIf"],["class","no-events",4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[1,"events-list-card"],[1,"events-list"],["class","event-item",3,"class",4,"ngFor","ngForOf"],[1,"event-item"],[1,"event-summary"],[1,"event-time-type"],[1,"event-time"],[1,"event-icon"],[1,"event-type"],[1,"event-team"],[1,"event-details"],[1,"event-description"],["class","event-player",4,"ngIf"],["class","event-notes",4,"ngIf"],[1,"event-actions"],["mat-icon-button","","matTooltip","Edit Event",3,"click"],["mat-icon-button","","matTooltip","Delete Event",1,"delete-btn",3,"click"],[1,"event-player"],[1,"event-notes"],[1,"no-events"]],template:function(i,o){if(i&1&&(t(0,"div",0)(1,"h2",1)(2,"mat-icon"),n(3,"sports_rugby"),e(),n(4," Match Events Manager "),e(),t(5,"div",2)(6,"strong"),n(7),e(),t(8,"span",3),n(9),D(10,"date"),e()(),t(11,"mat-dialog-content",4)(12,"mat-card",5)(13,"mat-card-header")(14,"mat-card-title"),n(15,"Add New Event"),e()(),t(16,"mat-card-content")(17,"form",6)(18,"div",7)(19,"mat-form-field",8)(20,"mat-label"),n(21,"Game Time"),e(),h(22,"input",9),t(23,"mat-hint"),n(24,"Format: MM:SS (e.g., 15:30)"),e(),f(25,Se,2,0,"mat-error",10),e(),t(26,"mat-form-field",8)(27,"mat-label"),n(28,"Period"),e(),t(29,"mat-select",11)(30,"mat-option",12),n(31,"First Half"),e(),t(32,"mat-option",13),n(33,"Second Half"),e(),t(34,"mat-option",14),n(35,"Extra Time"),e()()()(),t(36,"div",7)(37,"mat-form-field",8)(38,"mat-label"),n(39,"Event Type"),e(),t(40,"mat-select",15)(41,"mat-option",16)(42,"span",17),n(43,"\u{1F3C9} Try (5 points)"),e()(),t(44,"mat-option",18)(45,"span",17),n(46,"\u26BD Conversion (2 points)"),e()(),t(47,"mat-option",19)(48,"span",17),n(49,"\u{1F3AF} Penalty (3 points)"),e()(),t(50,"mat-option",20)(51,"span",17),n(52,"\u{1F3C8} Drop Goal (3 points)"),e()(),t(53,"mat-option",21)(54,"span",17),n(55,"\u{1F7E8} Card"),e()(),t(56,"mat-option",22)(57,"span",17),n(58,"\u{1FA79} Injury"),e()(),t(59,"mat-option",23)(60,"span",17),n(61,"\u{1F504} Substitution"),e()(),t(62,"mat-option",24)(63,"span",17),n(64,"\u{1F4DD} Other"),e()()()(),t(65,"mat-form-field",8)(66,"mat-label"),n(67,"Team"),e(),t(68,"mat-select",25)(69,"mat-option",26),n(70),e(),t(71,"mat-option",27),n(72),e()()()(),t(73,"mat-form-field",28)(74,"mat-label"),n(75,"Our Player (if applicable)"),e(),h(76,"input",29),t(77,"mat-hint"),n(78,"Focus on tracking your own team's player performance"),e()(),t(79,"mat-form-field",28)(80,"mat-label"),n(81,"Event Description"),e(),h(82,"textarea",30),e(),t(83,"mat-form-field",28)(84,"mat-label"),n(85,"Additional Notes"),e(),h(86,"textarea",31),t(87,"mat-hint"),n(88,"Editable notes for careful wording"),e()(),t(89,"div",32)(90,"button",33),c("click",function(){return o.addEvent()}),t(91,"mat-icon"),n(92,"add"),e(),n(93," Add Event "),e(),t(94,"button",34),c("click",function(){return o.resetForm()}),t(95,"mat-icon"),n(96,"clear"),e(),n(97," Clear "),e()()()()(),f(98,Oe,7,2,"mat-card",35)(99,Ie,7,0,"div",36),e(),t(100,"mat-dialog-actions",37)(101,"button",38),c("click",function(){return o.close()}),n(102,"Close"),e(),t(103,"button",39),c("click",function(){return o.saveAndClose()}),n(104," Save & Close "),e()()()),i&2){let l;r(7),b("",o.data.match.homeTeam," vs ",o.data.match.awayTeam,""),r(2),v(O(10,11,o.data.match.date,"MMM dd, yyyy")),r(8),d("formGroup",o.eventForm),r(5),d("pattern",o.timePattern),r(3),d("ngIf",(l=o.eventForm.get("time"))==null?null:l.invalid),r(45),g("",o.data.match.homeTeam," (Home)"),r(2),g("",o.data.match.awayTeam," (Away)"),r(18),d("disabled",o.eventForm.invalid||o.isLoading),r(8),d("ngIf",o.events&&o.events.length>0),r(),d("ngIf",!o.events||o.events.length===0)}},dependencies:[w,I,T,F,ue,le,oe,re,me,ce,pe,de,se,X,K,W,Q,L,V,G,ae,ie,ee,ne,te,fe,ge,Me,_e,k,$,R,Z,he,q,A,N,j,B,z,Ce,Ee],styles:[".event-manager-container[_ngcontent-%COMP%]{width:100%;max-width:800px}.match-info[_ngcontent-%COMP%]{padding:1rem;background:#f5f5f5;border-radius:8px;margin-bottom:1rem;display:flex;justify-content:space-between;align-items:center}.dialog-content[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}.event-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.event-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.event-form[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.event-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1rem}.events-list[_ngcontent-%COMP%]   .event-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem;border:1px solid #e0e0e0;border-radius:8px;margin-bottom:1rem}.events-list[_ngcontent-%COMP%]   .event-item.event-try[_ngcontent-%COMP%]{border-left:4px solid #4caf50}.events-list[_ngcontent-%COMP%]   .event-item.event-penalty[_ngcontent-%COMP%]{border-left:4px solid #ff9800}.events-list[_ngcontent-%COMP%]   .event-item.event-card[_ngcontent-%COMP%]{border-left:4px solid #f44336}.events-list[_ngcontent-%COMP%]   .event-summary[_ngcontent-%COMP%]{flex:1}.events-list[_ngcontent-%COMP%]   .event-summary[_ngcontent-%COMP%]   .event-time-type[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:600}.events-list[_ngcontent-%COMP%]   .event-summary[_ngcontent-%COMP%]   .event-team[_ngcontent-%COMP%]{font-size:.9rem;margin-top:.25rem}.events-list[_ngcontent-%COMP%]   .event-summary[_ngcontent-%COMP%]   .event-team.home[_ngcontent-%COMP%]{color:#4caf50}.events-list[_ngcontent-%COMP%]   .event-summary[_ngcontent-%COMP%]   .event-team.away[_ngcontent-%COMP%]{color:#2196f3}.events-list[_ngcontent-%COMP%]   .event-details[_ngcontent-%COMP%]{flex:2;margin:0 1rem}.events-list[_ngcontent-%COMP%]   .event-details[_ngcontent-%COMP%]   .event-description[_ngcontent-%COMP%]{margin-bottom:.5rem}.events-list[_ngcontent-%COMP%]   .event-details[_ngcontent-%COMP%]   .event-player[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;color:#4caf50;font-size:.9rem}.events-list[_ngcontent-%COMP%]   .event-details[_ngcontent-%COMP%]   .event-notes[_ngcontent-%COMP%]{color:#666;font-size:.85rem;margin-top:.25rem}.events-list[_ngcontent-%COMP%]   .event-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{color:#f44336}.no-events[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;color:#666}.no-events[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:4rem;width:4rem;height:4rem;margin-bottom:1rem;opacity:.5}@media (max-width: 600px){.event-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.event-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}}"]})};export{ye as a};
